<!DOCTYPE html>
<html layout:decorate="~{_layouts/admin_layout}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>쿠폰 목록</title>
</head>
<body>
<div layout:fragment="admin_content">
    <div class="admin-page-header">
        <h1 class="admin-page-title">
            <i class="fas fa-ticket-alt"></i> 쿠폰 목록
        </h1>
        <div>
            <a th:href="@{/admin/coupon-types/new}" class="admin-btn admin-btn--secondary">
                <i class="fas fa-plus"></i> 쿠폰 정책 등록
            </a>
            <a th:href="@{/admin/coupons/new}" class="admin-btn admin-btn--primary">
                <i class="fas fa-plus"></i> 쿠폰 등록
            </a>
        </div>
    </div>

    <!-- 검색 필터는 일단 비활성화 상태로 유지 -->
    <div class="admin-panel">
        <div class="admin-panel__body">
            <form th:action="@{/admin/coupons}" method="get" th:object="${searchCriteria}" class="admin-form">
                <div class="search-filters" style="display:none;"><!-- 추후 구현 예정 -->
                </div>
            </form>
        </div>
    </div>

    <!-- 쿠폰 목록 -->
    <div class="admin-panel" style="margin-top: 20px;">
        <div class="admin-panel__header">
            <h2 class="admin-panel__title"><i class="fas fa-list-ul"></i> 전체 쿠폰</h2>
        </div>
        <div class="admin-panel__body">
            <table class="admin-table">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>쿠폰 이름</th>
                    <th>적용 대상</th>
                    <th>세부 대상</th>
                    <th>연관 이름</th>
                    <th>쿠폰 정책명</th>
                    <th>등록일</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${#lists.isEmpty(coupons)}">
                    <td colspan="7" style="text-align:center;">등록된 쿠폰이 없습니다.</td>
                </tr>
                <tr th:each="coupon : ${coupons}">
                    <td th:text="${coupon.id}">1</td>
                    <td th:text="${coupon.couponName}">IT 카테고리 쿠폰</td>
                    <td th:text="${coupon.target == T(shop.bluebooktle.common.domain.CouponTypeTarget).ORDER ? '주문' : '도서'}"></td>
                    <td th:text="${coupon.bookId != null ? '도서' : (coupon.categoryId != null ? '카테고리' : '-')}"/>
                    <td th:text="${coupon.bookName != null ? coupon.bookName : (coupon.categoryName != null ? coupon.categoryName : '-')}"/>
                    <td th:text="${coupon.couponTypeName}">10,000원 이상 구매시 1000원 할인</td>
                    <td th:text="${#temporals.format(coupon.createdAt, 'yyyy-MM-dd')}">2025-05-01</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div th:if="${totalPages != null and totalPages > 0}" class="admin-panel__footer pagination-container">
            <th:block th:replace="~{_fragments/admin_pagination :: commonPagination(
                        currentPage=${currentPage + 1},
                        totalPages=${totalPages},
                        baseUrl=${baseUrlWithParams},
                        searchKeyword=${searchKeyword}
            )}"></th:block>
        </div>
    </div>
</div>
</body>
</html>
