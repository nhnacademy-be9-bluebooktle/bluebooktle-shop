<!DOCTYPE html>
<html layout:decorate="~{_layouts/default_layout}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">

<head>
    <title>회원가입 (Mock)</title>
    <style>
        .signup-form-container-kitsch {
            max-width: 650px;
            margin: 3rem auto;
            padding: 2.5rem;
            background-color: var(--kitsch-bg-alt);
            border: 3px solid var(--kitsch-text-dark);
            border-radius: 10px;
            box-shadow: 5px 5px 0px var(--kitsch-color-3);
        }

        .signup-form-container-kitsch .form-title-kitsch {
            font-family: var(--font-display);
            font-size: 2.2rem;
            color: var(--kitsch-color-5);
            text-align: center;
            margin-bottom: 2rem;
        }

        .form-group-kitsch {
            margin-bottom: 1.2rem;
        }

        .form-group-kitsch .label-kitsch {
            display: block;
            margin-bottom: 0.4rem;
            color: var(--kitsch-color-1);
            font-family: var(--font-handwriting);
            font-size: 1.15em;
        }

        .form-group-kitsch .input-kitsch {
            margin-bottom: 0.2rem;
        }

        .input-description-kitsch {
            font-family: var(--font-pixel);
            font-size: 0.75rem;
            color: var(--kitsch-text-dark);
            opacity: 0.8;
        }

        .address-group-kitsch {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .address-group-kitsch .input-kitsch {
            flex-grow: 1;
        }

        .address-group-kitsch .small-btn-kitsch {
            white-space: nowrap;
        }


        .terms-agreement-kitsch {
            margin-top: 2rem;
            padding: 1.5rem;
            border: 2px dashed var(--kitsch-color-2);
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.4);
        }

        .terms-agreement-kitsch .checkbox-kitsch {
            margin-bottom: 0.8rem;
            font-family: var(--font-pixel);
            font-size: 0.9rem;
        }

        .terms-agreement-kitsch .checkbox-kitsch label {
            display: flex;
            align-items: center;
        }

        .terms-agreement-kitsch .checkbox-custom-kitsch {
            margin-top: -2px;
        }

        .terms-link-kitsch {
            color: var(--kitsch-color-4);
            text-decoration: underline dotted;
            font-weight: bold;
        }

        .terms-link-kitsch:hover {
            color: var(--kitsch-color-3);
        }

        .field-error {
            font-family: var(--font-pixel);
            color: var(--kitsch-color-3);
            font-size: 0.8rem;
            margin-top: 0.2rem;
            display: block;
        }

    </style>
</head>

<body>
<div layout:fragment="content">
    <div class="container-kitsch">
        <div class="signup-form-container-kitsch">
            <h2 class="form-title-kitsch display-font-kitsch"><i class="fas fa-ghost"></i> 회원가입 (Mock Data) <i
                    class="fas fa-heart"></i></h2>

            <form th:action="@{/signup}" method="post">
                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch e" for="name">이름:</label>
                    <input class="input-kitsch pixel-font-kitsch error-kitsch" id="name" name="name"
                           placeholder="실명을 입력해주세요"
                           required type="text" value="고길동">
                    <span class="field-error">이름은 필수 항목입니다.</span>
                </div>

                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch" for="memberId">아이디:</label>
                    <input class="input-kitsch pixel-font-kitsch" id="memberId" name="memberId"
                           placeholder="영문, 숫자 조합 6~12자"
                           required type="text" value="user123">
                    <p class="input-description-kitsch">아이디 중복 확인 기능은 JS로 구현 필요</p>
                </div>

                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch" for="password">비밀번호:</label>
                    <input class="input-kitsch pixel-font-kitsch" id="password" name="password"
                           placeholder="영문, 숫자, 특수문자 포함 8자 이상"
                           required type="password" value="password123!">
                </div>

                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch" for="passwordConfirm">비밀번호 확인:</label>
                    <input class="input-kitsch pixel-font-kitsch error-kitsch" id="passwordConfirm"
                           name="passwordConfirm"
                           placeholder="비밀번호를 다시 입력해주세요" required type="password"
                           value="password123!">
                    <span class="field-error">비밀번호가 일치하지 않습니다. </span>
                </div>

                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch" for="email">이메일:</label>
                    <input class="input-kitsch pixel-font-kitsch" id="email" name="email"
                           placeholder="예: blue@booktle.com"
                           required type="email" value="test@example.com">
                </div>

                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch" for="nickname">닉네임:</label>
                    <input class="input-kitsch pixel-font-kitsch" id="nickname" name="nickname"
                           placeholder="닉네임을 입력해주세요 (20자 이하)"
                           required type="text" value="닉네임123">
                </div>

                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch" for="phoneNumber">연락처:</label>
                    <input class="input-kitsch pixel-font-kitsch" id="phoneNumber" name="phoneNumber"
                           placeholder="'-' 없이 숫자만 입력"
                           required type="tel" value="01012345678">
                </div>

                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch" for="birthDate">생년월일:</label>
                    <input class="input-kitsch pixel-font-kitsch" id="birthDate" name="birthDate" required type="date"
                           value="1990-05-15">
                </div>

                <div class="form-group-kitsch">
                    <label class="label-kitsch handwriting-font-kitsch">주소:</label>
                    <div class="address-group-kitsch" style="margin-bottom: 0.5rem;">
                        <input class="input-kitsch pixel-font-kitsch" id="postcode" name="postcode" placeholder="우편번호"
                               readonly type="text" value="12345">
                        <button class="btn-kitsch secondary-btn-kitsch color1-kitsch retro-shadow-kitsch-small small-btn-kitsch"
                                onclick="execDaumPostcode()"
                                type="button">
                            우편번호 찾기
                        </button>
                    </div>
                    <input class="input-kitsch pixel-font-kitsch" id="address" name="address" placeholder="도로명 주소"
                           readonly style="margin-bottom: 0.5rem;" type="text" value="경기도 성남시 분당구 대왕판교로">
                    <input class="input-kitsch pixel-font-kitsch" id="detailAddress" name="detailAddress"
                           placeholder="상세주소 입력"
                           type="text" value="645번길 NHN 플레이뮤지엄">
                </div>


                <div class="terms-agreement-kitsch">
                    <div class="checkbox-kitsch">
                        <label>
                            <input id="agreeAll" name="agreeAll" onchange="checkAllAgreements(this.checked)"
                                   type="checkbox">
                            <span class="checkbox-custom-kitsch"></span>
                            <span style="margin-left: 0.5em; font-weight: bold;">모든 약관에 동의합니다.</span>
                        </label>
                    </div>
                    <hr style="border: 1px dashed var(--kitsch-color-4); margin: 1rem 0;">
                    <div class="checkbox-kitsch">
                        <label>
                            <input checked class="agreement-checkbox" id="termsOfService" name="termsOfService"
                                   required type="checkbox" value="true">
                            <span class="checkbox-custom-kitsch"></span>
                            <span style="margin-left: 0.5em;">[필수] <a class="terms-link-kitsch" target="_blank"
                                                                      th:href="@{/legal/terms}">이용약관</a>에 동의합니다.</span>
                        </label>
                        <span class="field-error" style="margin-left: 25px;">이용약관 동의는 필수입니다.</span>
                    </div>
                    <div class="checkbox-kitsch">
                        <label>
                            <input class="agreement-checkbox" id="privacyPolicy" name="privacyPolicy" required
                                   type="checkbox" value="true"> <span class="checkbox-custom-kitsch"></span>
                            <span style="margin-left: 0.5em;">[필수]
                                <a class="terms-link-kitsch" target="_blank"
                                   th:href="@{/legal/privacy}">개인정보 수집 및 이용</a>에 동의합니다.</span>
                        </label>
                    </div>
                    <div class="checkbox-kitsch">
                        <label>
                            <input checked class="agreement-checkbox" id="marketingOptIn" name="marketingOptIn"
                                   type="checkbox" value="true">
                            <span class="checkbox-custom-kitsch"></span>
                            <span style="margin-left: 0.5em;">[선택] 마케팅 정보 수신에 동의합니다. (이메일, SMS)</span>
                        </label>
                    </div>
                </div>

                <button class="btn-kitsch primary-btn-kitsch retro-shadow-kitsch" style="width: 100%; margin-top: 2rem;"
                        type="submit">
                    <i class="fas fa-user-plus"></i> 가입하기
                </button>
            </form>
        </div>
    </div>
</div>

<th:block layout:fragment="page_scripts">
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script>
        function execDaumPostcode() {
            new daum.Postcode({
                oncomplete: function (data) {
                    var addr = '';
                    if (data.userSelectedType === 'R') {
                        addr = data.roadAddress;
                    } else {
                        addr = data.jibunAddress;
                    }
                    document.getElementById('postcode').value = data.zonecode;
                    document.getElementById("address").value = addr;
                    document.getElementById("detailAddress").focus();
                }
            }).open();
        }

        function checkAllAgreements(isAllChecked) {
            document.querySelectorAll('.agreement-checkbox').forEach(function (checkbox) {
                checkbox.checked = isAllChecked;
            });
        }

        document.querySelectorAll('.agreement-checkbox').forEach(function (checkbox) {
            checkbox.addEventListener('change', function () {
                let allRequiredChecked = true;
                document.querySelectorAll('.agreement-checkbox[required]').forEach(function (reqCheckbox) {
                    if (!reqCheckbox.checked) {
                        allRequiredChecked = false;
                    }
                });
                // 모든 '필수' 항목이 체크되었는지 여부만으로 '모두 동의'를 결정
                document.getElementById('agreeAll').checked = allRequiredChecked;

                // 만약 선택 항목까지 모두 동의해야 '모두 동의'가 체크되도록 하려면 아래 로직 사용
                /*
                let allAgreementsChecked = true;
                 document.querySelectorAll('.agreement-checkbox').forEach(function(cb) {
                    if (!cb.checked) {
                        allAgreementsChecked = false;
                    }
                });
                document.getElementById('agreeAll').checked = allAgreementsChecked;
                */
            });
        });

        // 페이지 로드 시 초기 '모두 동의' 상태 설정
        window.addEventListener('DOMContentLoaded', (event) => {
            let allRequiredCheckedInitially = true;
            document.querySelectorAll('.agreement-checkbox[required]').forEach(function (reqCheckbox) {
                if (!reqCheckbox.checked) {
                    allRequiredCheckedInitially = false;
                }
            });
            document.getElementById('agreeAll').checked = allRequiredCheckedInitially;

            // Mock 데이터로 인해 privacyPolicy가 체크 안된 상태이므로, 모두 동의는 초기에 체크 해제되어야 함.
            // 만약 privacyPolicy도 checked라면 이 코드는 true로 설정함.
        });

    </script>
</th:block>

</body>
</html>